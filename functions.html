<!DOCTYPE html><html><head>
<meta charset="utf-8"/>
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
<script>
  Office.onReady(() => {
    Office.actions.associate("onMessageSend", onMessageSend);
  });
  async function onMessageSend(event){
    try{
      await Office.addin.showAsTaskpane();   // OK/Cancel は taskpane 側で
      event.completed({ allowEvent:false }); // いったん止める
    }catch(e){
      console.error(e);
      event.completed({ allowEvent:false });
    }
  }
</script></head><body></body></html>
