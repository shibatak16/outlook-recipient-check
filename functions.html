<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
<script>
  Office.onReady(() => {
    Office.actions.associate("onMessageSend", onMessageSend);
  });

  async function onMessageSend(event) {
    try {
      // ここで必要なら宛先チェック等を実施（省略可）

      // タスクペインを開いて「OK/キャンセル」確認へ
      await Office.addin.showAsTaskpane();

      // 送信は一旦止める（OKなら taskpane 側で sendAsync する）
      event.completed({ allowEvent: false });
    } catch (e) {
      console.error(e);
      event.completed({ allowEvent: false });
    }
  }
</script>
</head>
<body></body></html>